encoder:
  dense_model: sentence-transformers/allenai-specter
  sparse_model: naver/splade-v3
  max_length: 512
  normalize_dense: true
  device: null
  use_specter2: true
  specter2_base_adapter: allenai/specter2  # For document embeddings
  specter2_query_adapter: allenai/specter2_adhoc_query  # For query embeddings

index:
  batch_size: 16  # Batch size for encoding documents
  chunk_size: 10000  # Number of docs per chunk for sparse encoding
  sparse_encoder_batch_size: 4  # SPLADE encoder batch size (to manage VRAM)

search:
  top_k: 10
  rrf_k: 60

citation:
  enabled: true  # Enable citation-based scoring
  data_file: data/citations.json  # Citation count lookup file
  score_formula: log  # 'log' for log(n+1) or 'log10' for log10(n+1)
  normalize: true  # Normalize citation scores to [0, 1]
  missing_default: 0.0  # Default score for papers without citation data

query_rewriting:
  enabled: true  # Enable LLM-based filter extraction and query rewriting
  model: "Qwen/Qwen3-4B-Instruct-2507-FP8"  # Qwen model for filter extraction
  max_length: 128
  temperature: 0.3
  num_rewrites: 1  # Number of query rewrites to generate
  device: null  # null = auto-detect (cuda if available, else cpu)
  filter_confidence_threshold: 0.7  # Minimum confidence to apply filters (0-1)
  enable_citation_filters: false  # Enable citation_count filters (requires citation data in Milvus)
  enable_year_filters: true  # Enable year filters

reranker:
  enabled: true
  # type: cross-encoder
  # model: cross-encoder/ms-marco-MiniLM-L-12-v2 
  # type: qwen
  # model: Qwen/Qwen3-Reranker-0.6B
  type: jina
  model: jinaai/jina-reranker-v3
  rerank_top_k: 50
  max_length: 512
  batch_size: 50  # Qwen: 8-16 (long sequences). Jina: MUST equal rerank_top_k (50) for listwise comparison of all docs at once!
  citation_boost_weight: 0  # Weight for citation boost (0 = disabled)
  instruction: null  # Custom instruction for reranker (null = use model default)

data:
  jsonl_file: data/arxiv_1k.jsonl
  text_key: abstract
  id_key: id
  title_key: title
  use_metadata: true
  categories_key: categories
  authors_key: authors
  year_key: published_date  # Field containing year/date information
  metadata_template: 'Title: {title}


    Authors: {authors}


    Year: {year}


    Categories: {categories}


    Abstract: {abstract}'
    
milvus:
  host: localhost
  port: 19530
  collection_name: arxplorer_papers
  # Index parameters
  dense_index_type: IVF_FLAT  # IVF_FLAT, HNSW, or FLAT
  dense_nlist: 1024  # Number of clusters for IVF
  dense_nprobe: 64  # Number of clusters to search
  sparse_index_type: SPARSE_INVERTED_INDEX
  # Connection settings
  connection_timeout: 30
  # Batch insert settings
  batch_size: 1000  # Insert documents in batches
